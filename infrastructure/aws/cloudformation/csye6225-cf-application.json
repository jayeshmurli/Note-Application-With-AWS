{
   "AWSTemplateFormatVersion" : "2010-09-09",
   "Parameters" : {
        "NetworkStackName": {
            "Type": "String",
            "Description" : "Please enter string for stack name"
         },
        "ImageId": {
            "Type": "String",
            "Description" : "Please enter string for AMI Image Id"
         },
        "KeyName": {
            "Type": "String",
            "Description" : "Please enter string for Key Name"
         },
         "WebServerSGID": {
             "Type": "String",
             "Description" : "Please enter string for web server security group"
         },
         "DBServerSGID": {
             "Type": "String",
             "Description" : "Please enter string for db server security group"
         },
         "Subnet1": {
             "Type": "String",
             "Description" : "Please enter string for subnet 1"
         },
         "Subnet2": {
             "Type": "String",
             "Description" : "Please enter string for subnet 2"
         },
         "Subnet3": {
             "Type": "String",
             "Description" : "Please enter string for subnet 3"
         }
   },
   "Resources" : {
       "WebServerInstance": {  
           "Type": "AWS::EC2::Instance",
           "Properties": {
               "InstanceType"   : "t2.micro",
               "ImageId"	: {"Ref" : "ImageId" },
           "KeyName"	: {"Ref" : "KeyName" },
           "SecurityGroupIds": [
            {"Ref" : "WebServerSGID" }
           ],
           "SubnetId" : {"Ref" : "Subnet1" }
           }
       },
       "DynamoDBInstance" : {
           "Type" : "AWS::DynamoDB::Table",
	   "Properties" : {
	       "TableName": "csye6225",
	       "AttributeDefinitions" : [ { 
	           "AttributeName" : "id", 
	           "AttributeType" : "S" 
	       } ],
	       "KeySchema" : [ { 
	           "AttributeName" : "id",
	           "KeyType" : "HASH"
	       } ],
	       "ProvisionedThroughput" : {
                   "ReadCapacityUnits" : "5",
                   "WriteCapacityUnits" : "5"
               }   
           }
       },
       "myDBSubnetGroup" : {
         "Type" : "AWS::RDS::DBSubnetGroup",
         "Properties" : {
            "DBSubnetGroupDescription" : "DB subnet group for RDS",
            "SubnetIds" : [ 
                {"Ref" : "Subnet1" },{"Ref" : "Subnet2" }
	   	          ],
            "Tags" : [ {"Key" : "String", "Value" : "String"} ]
         }
       },
       "MariaDBInstance" : {
           "Type" : "AWS::RDS::DBInstance",
           "Properties" : {
               "DBName" : "csye6225",
               "DBInstanceClass" : "db.t2.medium",
	       "AllocatedStorage" : "50",
	       "MultiAZ" : false,
	       "DBSubnetGroupName" : { "Ref" : "myDBSubnetGroup" },
	       "DBInstanceIdentifier" : "csye6225-spring2019",	       
               "Engine" : "MariaDB",
               "MasterUsername" : "csye6225master" ,
               "MasterUserPassword" : "csye6225password",
	       "PubliclyAccessible" : true,
               "Tags" : [ { "Key" : "Name", "Value" : "My SQL Database" } ],
               "VPCSecurityGroups": [
                {"Ref" : "DBServerSGID" }
               ]
           },
           "DeletionPolicy" : "Snapshot"
       }
   }  
}   
